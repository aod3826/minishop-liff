<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minishop-v3</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-slate-50 text-slate-800">
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-card">
      <div class="loading-spinner"></div>
      <p class="mt-4 text-sm text-slate-600">กำลังโหลดข้อมูลร้านค้า...</p>
    </div>
  </div>

  <header class="relative overflow-hidden bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white">
    <div class="container mx-auto px-6 py-10">
      <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
        <div>
          <h1 class="text-3xl font-bold tracking-tight">Minishop-v3</h1>
          <p class="mt-2 text-sm text-white/90">ร้านค้าชุมชนครบวงจร สั่งง่าย ส่งไว ปลอดภัยทุกขั้นตอน</p>
          <div id="liff-profile" class="mt-4 hidden items-center gap-3 rounded-2xl bg-white/15 px-4 py-3 backdrop-blur">
            <img id="profile-image" alt="Profile" class="h-12 w-12 rounded-full border-2 border-white object-cover" />
            <div>
              <p id="profile-name" class="text-sm font-semibold"></p>
              <p id="profile-id" class="text-xs text-white/80"></p>
            </div>
          </div>
        </div>
        <div class="flex gap-3">
          <button id="btn-track-order" class="btn-outline">
            <i class="fa-solid fa-receipt"></i>
            ติดตามออเดอร์
          </button>
          <button id="btn-admin" class="btn-primary">
            <i class="fa-solid fa-shield-halved"></i>
            Admin
          </button>
        </div>
      </div>
    </div>
    <div class="absolute -bottom-10 left-0 right-0 h-24 bg-gradient-to-t from-slate-50"></div>
  </header>

  <main class="container mx-auto px-6 pb-32">
    <section class="-mt-10 rounded-3xl bg-white p-6 shadow-xl">
      <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
        <div>
          <h2 class="text-xl font-semibold">รายการสินค้า</h2>
          <p class="text-sm text-slate-500">เลือกสินค้าที่ต้องการ แล้วเพิ่มลงตะกร้า</p>
        </div>
        <div class="flex flex-col gap-3 sm:flex-row">
          <div class="relative">
            <i class="fa-solid fa-magnifying-glass pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
            <input id="search-input" type="text" placeholder="ค้นหาสินค้า" class="w-full rounded-xl border border-slate-200 bg-slate-50 py-2 pl-10 pr-4 text-sm focus:border-indigo-400 focus:outline-none" />
          </div>
          <select id="category-filter" class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-2 text-sm focus:border-indigo-400 focus:outline-none">
            <option value="all">ทุกหมวดหมู่</option>
          </select>
        </div>
      </div>
    </section>

    <section id="product-grid" class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      <div class="col-span-full rounded-2xl border border-dashed border-slate-200 bg-white p-8 text-center text-slate-500">
        <i class="fa-solid fa-box-open text-3xl text-slate-300"></i>
        <p class="mt-3">กำลังโหลดสินค้า...</p>
      </div>
    </section>
  </main>

  <div id="cart-bar" class="cart-bar">
    <div class="flex items-center gap-4">
      <div class="cart-qty">0</div>
      <div>
        <p class="text-sm font-semibold">ตะกร้าสินค้า</p>
        <p class="text-xs text-white/80">แตะเพื่อดูรายละเอียด</p>
      </div>
    </div>
    <div class="text-right">
      <p class="text-xs text-white/70">ยอดรวม</p>
      <p id="cart-total" class="text-lg font-bold">0 ฿</p>
    </div>
  </div>

  <div id="cart-modal" class="modal hidden">
    <div class="modal-content">
      <div class="flex items-center justify-between border-b border-slate-100 pb-4">
        <h3 class="text-lg font-semibold">รายการสินค้าในตะกร้า</h3>
        <button class="modal-close" data-close="cart-modal"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div id="cart-items" class="mt-4 space-y-4"></div>
      <div class="mt-6 rounded-2xl bg-slate-50 p-4">
        <div class="flex items-center justify-between text-sm">
          <span>ยอดรวมสินค้า</span>
          <span id="cart-subtotal">0 ฿</span>
        </div>
        <div class="flex items-center justify-between text-sm">
          <span>ค่าส่ง</span>
          <span id="cart-shipping">0 ฿</span>
        </div>
        <div class="mt-2 flex items-center justify-between text-base font-semibold">
          <span>ยอดสุทธิ</span>
          <span id="cart-grandtotal">0 ฿</span>
        </div>
      </div>
      <form id="order-form" class="mt-6 space-y-4">
        <div>
          <label class="form-label">ชื่อผู้รับ</label>
          <input id="order-name" type="text" class="form-input" required />
        </div>
        <div>
          <label class="form-label">เบอร์โทรศัพท์</label>
          <input id="order-phone" type="tel" maxlength="10" class="form-input" required />
        </div>
        <div>
          <label class="form-label">ที่อยู่จัดส่ง</label>
          <textarea id="order-address" rows="3" class="form-input" required></textarea>
        </div>
        <div class="rounded-2xl bg-indigo-50 p-4">
          <p class="text-sm font-semibold text-indigo-700">ตัวเลือกการจัดส่ง</p>
          <div class="mt-3 flex flex-col gap-3">
            <label class="flex items-center gap-2 text-sm">
              <input type="radio" name="shippingType" value="pin" checked />
              ปักหมุดตำแหน่งเพื่อคำนวณระยะทาง
            </label>
            <div class="flex gap-2">
              <button id="btn-open-map" type="button" class="btn-outline flex-1">
                <i class="fa-solid fa-map-location-dot"></i>
                เปิดแผนที่
              </button>
              <button id="btn-current-location" type="button" class="btn-outline flex-1">
                <i class="fa-solid fa-location-crosshairs"></i>
                ใช้ตำแหน่งปัจจุบัน
              </button>
            </div>
            <label class="flex items-center gap-2 text-sm">
              <input type="radio" name="shippingType" value="manual" />
              พิมพ์ที่อยู่ (ค่าส่งเหมา)
            </label>
          </div>
          <p id="distance-display" class="mt-3 text-xs text-slate-500">ระยะทางยังไม่ถูกคำนวณ</p>
        </div>
        <div>
          <label class="form-label">แนบสลิปโอนเงิน</label>
          <input id="order-slip" type="file" accept="image/*" class="form-input" required />
        </div>
        <button id="btn-submit-order" type="submit" class="btn-primary w-full">
          <i class="fa-solid fa-paper-plane"></i>
          ส่งคำสั่งซื้อ
        </button>
      </form>
    </div>
  </div>

  <div id="map-modal" class="modal hidden">
    <div class="modal-content">
      <div class="flex items-center justify-between border-b border-slate-100 pb-4">
        <h3 class="text-lg font-semibold">เลือกตำแหน่งจัดส่ง</h3>
        <button class="modal-close" data-close="map-modal"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div id="map" class="mt-4 h-72 w-full rounded-2xl border border-slate-200"></div>
      <div class="mt-4 flex gap-3">
        <button id="btn-confirm-location" class="btn-primary flex-1">ยืนยันตำแหน่ง</button>
        <button data-close="map-modal" class="btn-outline flex-1">ยกเลิก</button>
      </div>
    </div>
  </div>

  <div id="admin-modal" class="modal hidden">
    <div class="modal-content">
      <div class="flex items-center justify-between border-b border-slate-100 pb-4">
        <h3 class="text-lg font-semibold">Admin Dashboard</h3>
        <button class="modal-close" data-close="admin-modal"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div id="admin-login" class="mt-4 space-y-4">
        <p class="text-sm text-slate-500">กรอกรหัสผ่านเพื่อเข้าสู่ระบบผู้ดูแล</p>
        <input id="admin-password" type="password" class="form-input" placeholder="รหัสผ่าน" />
        <button id="btn-admin-login" class="btn-primary w-full">เข้าสู่ระบบ</button>
      </div>
      <div id="admin-dashboard" class="mt-4 hidden">
        <div class="grid gap-4 lg:grid-cols-2">
          <div class="rounded-2xl border border-slate-100 p-4">
            <h4 class="text-sm font-semibold text-slate-600">จัดการสินค้า</h4>
            <div id="admin-product-list" class="mt-3 space-y-3"></div>
          </div>
          <div class="rounded-2xl border border-slate-100 p-4">
            <h4 class="text-sm font-semibold text-slate-600">ตั้งค่าร้านค้า</h4>
            <div class="mt-3 space-y-3">
              <label class="form-label">ละติจูดร้านค้า</label>
              <input id="setting-lat" type="number" step="0.000001" class="form-input" />
              <label class="form-label">ลองจิจูดร้านค้า</label>
              <input id="setting-lng" type="number" step="0.000001" class="form-input" />
              <label class="form-label">ค่าส่งเหมา (บาท)</label>
              <input id="setting-flat" type="number" class="form-input" />
              <label class="form-label">อัตราค่าส่ง/กม.</label>
              <input id="setting-distance" type="number" class="form-input" />
              <label class="form-label">รหัสผ่านผู้ดูแล</label>
              <input id="setting-password" type="password" class="form-input" />
              <button id="btn-save-settings" class="btn-primary w-full">บันทึกการตั้งค่า</button>
            </div>
          </div>
        </div>
        <div class="mt-4 rounded-2xl border border-slate-100 p-4">
          <h4 class="text-sm font-semibold text-slate-600">รายการออเดอร์ล่าสุด</h4>
          <div id="admin-order-list" class="mt-3 space-y-3"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="app.js"></script>
</body>
</html>
